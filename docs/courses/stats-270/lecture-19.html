<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    STATS 270: Bayesian Statistics
  </title>
  <meta
    name="description"
    content="A collection of work and research by Daniel jenson."
  />

  <!-- Google Fonts -->
  <link
    href="//fonts.googleapis.com/css?family=Lato:400,400italic"
    rel="stylesheet"
    type="text/css"
  />

  <!-- https://docs.mathjax.org/en/latest/input/tex/extensions/index.html -->
  <script>
    MathJax = {
      loader: {
        load: [
          "[tex]/ams",
          "[tex]/gensymb",
          "[tex]/mathtools",
          "[tex]/physics",
        ],
      },
      tex: {
        packages: { "[+]": ["ams", "gensymb", "mathtools", "physics"] },
        inlineMath: [
          ["$", "$"],
          ["\\(", "\\)"],
        ],
      },
      svg: {
        fontCache: "global",
      },
    };
  </script>
  <!-- https://www.mathjax.org/#gettingstarted -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
  ></script>
  <link rel="stylesheet" type="text/css" href="/notes/assets/css/main.css">

  <link
    rel="canonical"
    href="https://danjenson.github.io/notes/courses/stats-270/lecture-19.html"
  />
</head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
  <nav class="group">
     
    <a href="/notes/books">books</a>
      
    <a href="/notes/papers">papers</a>
      
    <a href="/notes/courses">courses</a>
      
    <a href="/notes/mindmaps">mindmaps</a>
     
    <button
      type="button"
      id="theme-toggle"
      onclick="modeSwitcher()"
      style="cursor: pointer"
    ></button>
  </nav>
  <script src="/notes/assets/js/theme-toggle.js"></script>
</header>

    <article class="group">
<h1 class="title">
  <a href=".">STATS 270: Bayesian Statistics</a>
</h1>
 
<h2 class="subtitle">Lecture 19: Doob's Theorem on Bayesian Consistency (2022-12-08)</h2>
 <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#doobs-theorem-on-bayesian-consistency">Doob’s Theorem on Bayesian Consistency</a></li>
</ul>\[\newcommand{\op}{\operatorname}
\newcommand{\var}[1]{\op{var}\left[#1\right]}
\newcommand{\sd}[1]{\op{sd}\left[#1\right]}
\newcommand{\cov}[2]{\op{cov}\left[#1, #2\right]}\]

<h2 id="doobs-theorem-on-bayesian-consistency">
<a class="anchor" href="#doobs-theorem-on-bayesian-consistency" aria-hidden="true"><span class="octicon octicon-link"></span></a>Doob’s Theorem on Bayesian Consistency</h2>

<ul>
  <li>Suppose $Y_1,Y_2,\ldots$ are iid according to $p_\theta(\cdot)$ and
$y\in\mathcal{Y}$, $\theta\in\Omega\in \mathbb{R}^k$ (a bounded rectangle)</li>
  <li>
<strong>Definition</strong>: An estimator $T_n=t_n(Y_1,\ldots,Y_n)$ is a consistent
estimator if $\forall \theta\in\Omega$, for any $\varepsilon&gt;0$, we have
$p_\theta(|T_n-\theta|&gt;\varepsilon)\to 0$ as $n\to\infty$.</li>
  <li>Let $\pi(\cdot)$ be a prior density and \(T_n^*=\mathbb{E}\left[\Theta\mid
Y_1,\ldots,Y_n\right]=t_n^*(Y_1,\ldots,Y_n)\)</li>
  <li>
    <p><strong>Theorem (Doob)</strong>: If there exists any consistent estimator, then the
\(T_n^*\) will satisfy the following:</p>

\[\begin{aligned}
p_\theta(\lim_{n\to\infty}T_n^*=\theta)
&amp;=1 \quad\text{strong consistentcy}\\
\end{aligned}\]

    <ul>
      <li>Except when $\theta$ is in a set of $\pi(\cdot)$ of probability 0.</li>
    </ul>
  </li>
  <li>
<strong>Proof</strong>:
    <ul>
      <li>
<strong>Prelude</strong>:
        <ul>
          <li>Consider the probability space $(\Omega\times\mathcal{Y}^\infty, Q)$</li>
          <li>Under $Q$, the sample point $(\theta, y_1,y_2,\ldots)$ is generated by
drawing $\theta\sim\pi(\cdot)$, then $y_1,y_2,\ldots$ are iid from
$p_\theta(\cdot)$</li>
        </ul>
      </li>
      <li>
<strong>Claim A</strong>:
        <ul>
          <li>There exists a random variable \(T_\infty^*\) on
\(\Omega\times\mathcal{Y}^\infty\) such that
\(T_\infty^*=g(\theta,y_1,y_2,\ldots)\), with
\(\mathbb{E}_{Q}\left[T_\infty^*\right]&lt;\infty\) such that
\(p_Q(T_n^*\to T_\infty^*)=1\)</li>
          <li>This means that \(p_Q\left(t_n^*(Y_1,\ldots,Y_n)\to
g(\Theta,Y_1,Y_2,\ldots)\right)=1\)</li>
        </ul>
      </li>
      <li>
<strong>Claim B</strong>:
        <ul>
          <li>
\[\mathbb{E}_{Q}\left[T_\infty^*-\Theta\right]^2=0\]
          </li>
          <li>So, \(p_Q(T_\infty^*=\Theta)=1\)</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>By Claim A, we can replace \(T_\infty^*\) by \(\lim_{n\to\infty}T_n^*\), then
\(p_Q(\lim_{n\to\infty}T_n^*=\Theta)=1\), which implies
\(1-p_Q(\lim_{n\to\infty}T_n^*=\Theta)=0\)</li>
  <li>Thus,</li>
</ul>

\[\begin{aligned}
\int_\Omega \pi(\theta)\dd\theta-\int_\Omega\pi(\theta)\underbrace{p_\theta(\lim_{n\to\infty}t_n^*(Y_1,\ldots,Y_n\mid\theta)}_{\lambda(\theta)}\dd\theta
&amp;=\int_\Omega \pi(\theta)(1-\lambda(\theta))\dd\theta=0
\end{aligned}\]

<ul>
  <li>This implies that $\lambda(\theta)=1$ unless $\pi(\theta)=0$</li>
  <li>So, \(p_\theta(\lim_{n\to\infty}T_n^*=\theta)=1\) unless $\pi(\theta)=0$.</li>
  <li>Hence, \(T_n^*\) is strongly consistent for almost all $\theta$ under the
prior.</li>
  <li>\(T_\infty^*=g(\theta,Y_1,Y_2,\ldots)=\theta\) except for $\theta$ in a
$\pi$-null set.</li>
  <li>In order to prove Claim A, we need a result form probability theory.</li>
  <li>$\mathcal{F}_n$ is the $\sigma$-filed of events generated by
\(X_1,X_2,\ldots,X_n\)</li>
  <li>Given \((\Lambda,\mathcal{F},P)\), let
\(\mathcal{F}_1\subset\mathcal{F}_2\subset\mathcal{F}_3\cdots\) be a sequences
of sub $\sigma$-fields and $X_n$ is measurable with respect to
$\mathcal{F}_n$, then \(\{(X_n,\mathcal{F}_n):n=1,2,\ldots\}\) is a martingale
if:
    <ol>
      <li>
\[\mathbb{E}\left[X_n\right]&lt;\infty\;\forall n\]
      </li>
      <li>With probability 1,
\(\mathbb{E}\left[X_{n+1}\mid\mathcal{F}_n\right]=X_n\)</li>
    </ol>
  </li>
  <li>Martingale Convergence Theorem (Doob)
    <ul>
      <li>Let $X_1,X_2,\ldots$ be a martingale and $\mathbb{E}\left[X_n\right]\le
k,\;\forall n$ then there exists a random variable $X$ with
$\mathbb{E}\left[X\right]&lt;k$ so that $X_n\to X$ with probability 1.</li>
      <li>This means that for any $\lambda\in\Lambda$ in the sample space
$X_1(\lambda),X_2(\lambda),\ldots$ is just a sequences of real numbers</li>
      <li>In general, this sequence may or may not converge to a limit.</li>
    </ul>
  </li>
  <li>To prove Claim A, start with \((\Omega\times\mathcal{Y}^\infty,Q)\)
    <ul>
      <li>Let \(\mathcal{F}_n\) be a $\sigma$-field generated by $Y_1,\ldots,Y_n$</li>
      <li>These are clearly increasing: \(\mathcal{F}_1\subset\mathcal{F}_2\cdots\)</li>
      <li>Furthermore,</li>
    </ul>
  </li>
</ul>

\[\begin{aligned}
\mathbb{E}\left[T_{n+1}^*\mid\mathcal{F}_n\right]=
&amp;=\mathbb{E}\left[\mathbb{E}\left[\Theta\mid Y_1,\ldots,Y_n,Y_{n+1}\right]\mid Y_1,\ldots,Y_n\right] \\
&amp;=\mathbb{E}\left[\Theta\mid Y_1,\ldots,Y_n\right] \\
&amp;=T_n^* \\
\end{aligned}\]

<ul>
  <li>So, the martingale convergence theorem applies, and there exists a random
variable \(T_\infty^*\) such that \(T_n^*\to T_\infty^*\) with $Q$ probability
1.</li>
  <li>
    <p>Proof of Claim B that \(\mathbb{E}_{Q}\left[T_\infty^*-\Omega\right]^2=0\)</p>

\[\begin{aligned}
\mathbb{E}_{Q}\left[T_n^*-\Theta\right]^2
&amp;= \mathbb{E}\left[\mathbb{E}\left[T_n^*-\Theta\right]^2\mid Y_1,\ldots,Y_n\right] \\
&amp;\le \mathbb{E}\left[\mathbb{E}\left[T_n-\Theta\right]^2\mid Y_1,\ldots,Y_n\right] \\
&amp;=\mathbb{E}_Q\left[T_n-\Theta\right]^2 \\
&amp;=\int_\Omega\pi(\theta)\underbrace{\mathbb{E}_{\theta}\left[T_n-\theta\right]^2}_{\text{by Claim C:}\to 0}\dd\theta
\\
\end{aligned}\]
  </li>
  <li>If $T_n$ is a consistent estimate guaranteed by the construction of the
theorem.</li>
  <li>Claim C: \(\mathbb{E}_{\theta}\left[T_n-\theta\right]^2\to0\)</li>
  <li>Apply the Bounded Convergence Theorem</li>
</ul>

\[\begin{aligned}
\mathbb{E}_{Q}\left[T_n^*-\Theta\right]^2
&amp;\to \mathbb{E}_{Q}\left[T_\infty^*-\Theta\right]^2=0 \\
\end{aligned}\]

<ul>
  <li>
    <p><strong>Proof of Claim C</strong>:</p>

    <ul>
      <li>Want to prove \(\mathbb{E}_{\theta}\left[T_n-\theta\right]^2\to 0\)</li>
      <li>Suppose \(|\Omega|&lt;M\)
\(\begin{aligned}
\mathbb{E}_{\theta}\left[T_n-\theta\right]^2
&amp;\le\int_{|T_n-\theta|&gt;\varepsilon}|T_n-\theta|^2\dd p_\theta(Y_1,\ldots,Y_n) +
  \int_{|T_n-\theta|&lt;\varepsilon}|T_n-\theta|^2\dd p_\theta(Y_1,\ldots,Y_n)
  \\
&amp;\le 4M^2 \underbrace{p_\theta(|T_n-\theta|&gt;\varepsilon)}_{\to 0\text{ as }n\to\infty} + 2\varepsilon^2 \\
&amp;\le 3\varepsilon^2 \\
\end{aligned}\)</li>
      <li>Thus, \(\mathbb{E}_{\theta}\left[T_n-\theta\right]^2\to 0\).</li>
    </ul>
  </li>
  <li>
    <p>Two loose ends.</p>

    <ol>
      <li>We have consistency with prior probability 1.</li>
      <li>There has to exist a consistent estimator. How can you guarantee the
existence of a consistent estimator?</li>
    </ol>
  </li>
  <li>
    <p><strong>Theorem</strong>: Let $X_1,X_2,\ldots$ iid according to $f_\theta(\cdot)$ and
$\theta\in\Omega$. If $\Omega$ is compact with respect to some metric,</p>

\[d(\theta,\theta')=\lVert f_\theta(\cdot)-f_{\theta'}(\cdot)\rVert=\int_\Omega
|f_\theta(y)-f_{\theta'}(y)|\dd\mu(y)\]

    <ul>
      <li>Then there exists and estimator $T_n$ such that
$d(T_n,\theta)\to_{p_\theta} 0$ for all $\theta\in\Omega$.</li>
    </ul>
  </li>
</ul>

</article>
    <span class="print-footer"
  >STATS 270: Bayesian Statistics - Daniel Jenson
</span>
 <footer>
  <hr class="slender">
  <ul class="footer-links">
    <li><a href="daniel.a.jenson@gmail.com"><span class="icon-mail3"></span></a></li>    
    
      <li>
        <a href="https://www.linkedin.com/in/daniel-jenson-7a002a30/"><span class="icon-linkedin"></span></a>
      </li>
    
      <li>
        <a href="https://github.com/danjenson"><span class="icon-github"></span></a>
      </li>
      
  </ul>
<div class="credits">
<span>&copy; 2023 &nbsp;&nbsp;DANIEL JENSON</span></br> <br>
<span>This site created with the <a href="//github.com/danjenson/et">Edward Tufte theme for Daniel Jenson </a> in <a href="//jekyllrb.com">Jekyll</a>.</span> 
</div>  
</footer>

  </body>
</html>
